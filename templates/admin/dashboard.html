<!-- templates/admin/dashboard.html -->

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/admin_dashboard.css') }}">
{% endblock %}

{% block content %}
<div class="admin-dashboard">
    <header class="dashboard-header">
        <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Logo" class="logo">
        <button class="logout-button" onclick="logout()">Logout</button>
    </header>

    <aside class="sidebar">
        <!-- Sidebar content -->
    </aside>

    <main class="dashboard-main">
        <!-- Provider Verification -->
        <div class="provider-verification">
            <h2>Provider Verification</h2>
            <p>This is a sneak peek. Should have a button that redirects to provider-verification frontend.</p>
            <button onclick="window.location.href='/admin/provider-verification'">Go to Provider Verification</button>
        </div>

        <!-- Dispute Reports -->
        <div class="dispute_reports">
            <div class="dispute-management">
                <h2>Dispute Management</h2>
                <p>This is a sneak peek. Should have a button that redirects to dispute-management frontend.</p>
                <button onclick="window.location.href='/admin/dispute-management'">Go to Dispute Management</button>
            </div>

            <div class="reports">
                <h2>Reports</h2>
                <li>Total Bookings: <span id="totalBookings">0</span></li>
                <li>Active Providers: <span id="activeProviders">0</span></li>
                <li>Total Customers: <span id="totalCustomers">0</span></li>
                <li>Open Disputes: <span id="openDisputes">0</span></li>
                <button onclick="window.location.href='/admin/reports'">Go to Reports</button>
            </div>
        </div>
    </main>
</div>

<script>
async function loadAdminData() {
    const token = localStorage.getItem('token');
    if (!token) return;

    try {
        // Load daily bookings
        const statsResponse = await fetch('/api/admin/reports/daily-bookings', {
            headers: { 'Authorization': `Bearer ${token}` }
        });

        if (statsResponse.ok) {
            const bookings = await statsResponse.json();
            document.getElementById('totalBookings').textContent = bookings.length;
            document.getElementById('activeProviders').textContent = '24';
            document.getElementById('totalCustomers').textContent = '156';
            document.getElementById('openDisputes').textContent = '3';
        }
    } catch (error) {
        console.error('Error loading admin data:', error);
    }
}

// Initialize
document.addEventListener('DOMContentLoaded', loadAdminData);
</script>
{% endblock %}
